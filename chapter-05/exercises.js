// /////////////////////////////////////////////////////////////////////////////
// flatten /////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////

function flatten(array,  output = []) {
  // Base 
  if  (array.length === 0) {
    return output;
  }


  var first = array[0];

  // recursion
  if (Array.isArray(first)){
  
    flatten(first, output);
  }  else {
  
    
    output.push(first);
  }


  return flatten(array.slice(1), output);
}

// /////////////////////////////////////////////////////////////////////////////
// loop ////////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////

function  loop(current,  check, nextValue,funct) {
  if ( !check(current)) {
  
    return;
  }

	funct(current);

  return loop(nextValue(current), check, nextValue, funct);
}

// /////////////////////////////////////////////////////////////////////////////
// every ///////////////////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////

function every(array, func) {
  for (var y = 0; y < array.length;  y++) {
  
    if (!func(array[y])) {
       return false;
    }
  }
  return true;
}

// /////////////////////////////////////////////////////////////////////////////
// dominantDirection ///////////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////

function dominantDirection(x) {
  var counts = countBy(x, function(char) {
   var script =  characterScript(char.codePointAt(0));
   return script ? script.direction :  "none";
  });

  counts = counts.filter(function(item) {
   return  item.name !=  "none";
  });

  if (counts.length === 0) {
  return "ltr";   
  }

  counts.sort(function(a, b) {
  return b.count - a.count;
  });

  return  counts[0].name;
}

// /////////////////////////////////////////////////////////////////////////////
//  //////////////////////////////////////////////////////
// /////////////////////////////////////////////////////////////////////////////

if ((typeof process !== 'undefined') &&
  (typeof process.versions.node !== 'undefined')) {
  module.exports = {
    flatten,
    loop,
    every,
    dominantDirection,
  };
};